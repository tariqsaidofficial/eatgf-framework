# Vulnerability Management Profile

> **Authority Notice:** This profile implements EATGF controls for vulnerability detection, assessment, remediation, and incident response across the software lifecycle. It does NOT define new controls, redefine severity, or override standards. This profile clarifies HOW organizations satisfy Incident Response (Layer 03), Audit & Assurance (Layer 06), and compliance requirements per ISO 27001 A.8.16 and NIST SP 800-53 SI-2.

## Purpose

Define governance controls for continuous vulnerability detection, severity assessment, automated remediation, and incident response workflows to ensure all known vulnerabilities are addressed within defined SLAs and compliance timelines.

**Applies to:**

- Third-party dependencies (runtime + development)
- Operating system packages (kernel, system libraries)
- Container base images
- Infrastructure code (Terraform, CloudFormation)
- Application-level components
- Zero-day vulnerability response

## Architectural Position

- **EATGF Layer:** 08_DEVELOPER_GOVERNANCE_LAYER / 06_AUDIT_AND_ASSURANCE (Primary) + Layer 03 (DevSecOps) + Layer 01 (Secure SDLC)
- **Governance Scope:** Vulnerability Detection, Assessment, Remediation, Incident Response, Compliance Reporting
- **Control Authority:** Implements controls from MASTER_CONTROL_MATRIX for vulnerability management (ISO 27001 A.8.16, NIST SP 800-53 SI-2, NIST SSDF RV.1)

## Relationship to EATGF Layers

### Layer 01: Secure SDLC

Vulnerability Management profiles enforce:

- **Build-time scanning:** SCA (Software Composition Analysis) on every dependency addition
- **Baseline establishment:** Acceptable vulnerability risk profile per language/framework
- **Policy enforcement:** Dependency updates blocked until vulnerability resolved

### Layer 03: DevSecOps Governance

Vulnerability Management profiles reference:

- **Continuous scanning:** SBOM consumed by multiple scanners (Grype, Trivy, OSV)
- **Automation:** CVE disclosure → automated build/test/deploy pipeline trigger
- **Escalation:** CRITICAL vulnerabilities escalate to on-call security engineer

### Layer 06: Audit & Assurance

Vulnerability Management profiles implement:

- **Compliance reporting:** CVE detection/remediation timelines tracked
- **Incident forensics:** Affected deployment versions correlated to CVE discovery
- **Post-incident review:** Root cause analysis for missed/delayed remediations

## Governance Principles

### 1. Continuous Vulnerability Detection

All artifacts scanned continuously, not just at release time.

```bash
#  COMPLIANT: Continuous scanning
# Daily scan of all published artifacts
0 2 * * * /usr/local/bin/trivy image-scan-all-registry.sh

# On-demand scan for new artifact
docker build -t app:v1.0 .
trivy image app:v1.0 --severity HIGH,CRITICAL --exit-code 1

# Runtime scanning (deployed container)
kubectl run -n security security-scanner -- \
  trivy image --json --output vuln-report.json
```

### 2. Multi-Source Vulnerability Data

Vulnerabilities aggregated from multiple authoritative sources.

```bash
# National Vulnerability Database (NVD)
# GitHub Security Advisory Database (GHSA)
# OSV (Open Source Vulnerabilities) Database
# Alpine Linux Security Database
# Debian Security Database
# npm Security Database

#  COMPLIANT: Grype aggregates all sources
grype app:v1.0 --source "nvd,github,osv" --output json

# Configure scanning with multiple backends
trivy image --severity HIGH,CRITICAL \
  --db-repository ghcr.io/aquasecurity/trivy-db:latest \
  app:v1.0
```

### 3. Risk-Based Severity Assessment

Vulnerability severity weighted by exploitability + business impact.

```json
{
  "vulnerability": {
    "id": "CVE-2023-12345",
    "severity": "CRITICAL",
    "cvss_v3": {
      "base_score": 9.8,
      "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
    },
    "exploitability": {
      "proof_of_concept_available": true,
      "public_exploit_available": true,
      "active_threats": true
    },
    "business_impact": {
      "affected_component": "authentication_library",
      "exposure": "customer_facing",
      "data_sensitivity": "high",
      "customer_impact": "potential_data_breach"
    },
    "remediation_timeline": {
      "severity": "CRITICAL",
      "response_time_sla": "1_hour",
      "patch_deadline": "24_hours"
    }
  }
}
```

### 4. Automated Patch Application

Security patches applied automatically when safe, human-reviewed when risky.

```bash
#  COMPLIANT: Automated patching policy
# Patch immediately if:
# - Dependency is in submodule/transitive (safe)
# - Patch is minor version bump (backward compatible)
# - No test failures in CI/CD

# Require human review if:
# - Dependency is direct (production stability risk)
# - Patch is major version bump (breaking changes)
# - New test failures introduced

# GitHub Actions Dependabot Config
version: 2
updates:
  - package-ecosystem: "pip"
    directory: "/"
    schedule:
      interval: "daily"
      time: "03:00"
    auto-commit-message: "Security patch: bump {{ dependency-name }}"
    pull-request-branch-name:
      separator: "/"
    reviewers:
      - "security-team"
    allow:
      - dependency-type: "direct"
    ignore:
      - dependency-name: "legacy-auth"
        versions: ["2.*"]  # Major version skipped
```

### 5. SLA-Driven Remediation

Remediation deadlines enforced based on CVE severity.

```yaml
# Remediation SLA Policy
vulnerability_sla_matrix:
  CRITICAL:
    detection_notification: 15_minutes
    patch_application: 1_hour
    deployment: 4_hours
    verification: 24_hours
  HIGH:
    detection_notification: 1_hour
    patch_application: 1_day
    deployment: 3_days
    verification: 1_week
  MEDIUM:
    detection_notification: 24_hours
    patch_application: 1_week
    deployment: 2_weeks
    verification: 1_month
  LOW:
    detection_notification: 1_week
    patch_application: 1_month
    deployment: 3_months
    verification: none

#  COMPLIANT: SLA tracking
notifications:
  - channel: "slack"
    severity: "CRITICAL" # Notify within 15 minutes
  - channel: "pagerduty"
    severity: "HIGH" # Escalate if patch pending > 4 hours
  - channel: "jira"
    severity: "MEDIUM" # Track as tech debt
```

### 6. Transitive Dependency Risk Assessment

Vulnerabilities in library dependencies (tree depth > 1) tracked separately.

```json
{
  "vulnerability_context": {
    "target": "app v1.0",
    "affected_dependency": "requests 2.28.0",
    "cve": "CVE-2023-32681",
    "direct_vs_transitive": "transitive",
    "dependency_chain": [
      "app v1.0",
      "httpx 0.24.0",  # Direct
      "requests 2.28.0"  # Transitive (2 levels)
    ],
    "risk_mitigation": {
      "option_1": "Update httpx to 0.24.1+ (includes requests 2.31.0+)",
      "option_2": "Exclude requests 2.28.0 from httpx dependency",
      "recommended": "Option 1"
    }
  }
}
```

## Governance Conformance

### Control 1: Continuous Vulnerability Scanning

**Root Standard:** ISO 27001 A.8.16 (Vulnerability Management)

**Implementation Pattern:**

- SCA tools run on every code commit
- Container images scanned before publication
- Runtime scanning enabled for deployed workloads
- Scan results aggregated into central dashboard

**Compliant Example:**

```yaml
# .github/workflows/scan.yml
name: Continuous Vulnerability Scan

on: [push, pull_request, schedule]

jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Generate SBOM
        run: |
          curl -sSfL https://raw.githubusercontent.com/anchore/syft/main/install.sh | sh -s -- -b /usr/local/bin
          syft packages . -o cyclonedx-json > sbom.json

      - name: SCA with Grype
        run: grype sbom.json --output json > vulns.json

      - name: Container Image Scan
        run: |
          docker build -t app:latest .
          trivy image app:latest --severity CRITICAL,HIGH --exit-code 1

      - name: Report Vulnerabilities
        if: always()
        run: |
          # Upload results to scanning system
          curl -X POST https://scanning-backend/api/vulnerabilities \
            -H "Authorization: Bearer ${{ secrets.SCAN_TOKEN }}" \
            -d @vulns.json
```

### Control 2: Multi-Source Vulnerability Aggregation

**Root Standard:** NIST SP 800-53 SI-2 (Information System Monitoring)

**Implementation Pattern:**

- Vulnerabilities collected from NVD, GHSA, OSV, distro-specific databases
- Deduplication and correlation (same vulnerability, different identifiers)
- Prioritization based on exploitability + business exposure

**Compliant Example:**

```bash
# Grype aggregates across sources
grype app:v1.0 \
  --sources "nvd,github,osv,alpine-secdb" \
  --fail-on CRITICAL,HIGH \
  --output json > report.json

# Parse results
cat report.json | jq '
  .matches | group_by(.vulnerability.id) | map({
    cve_id: .[0].vulnerability.id,
    sources: [.[].source.name] | unique,
    severity: .[0].vulnerability.severity,
    packages_affected: [.[].artifact.name] | unique
  })'
```

### Control 3: Severity-Based Remediation SLA

**Root Standard:** NIST SSDF RV.1 (Vulnerability Response)

**Implementation Pattern:**

- CRITICAL: Response within 1 hour, patch within 4 hours
- HIGH: Response within 24 hours, patch within 1 week
- MEDIUM: Response within 1 week, patch within 1 month
- SLA violations tracked as compliance concerns

**Compliant Example:**

```python
# Remediation tracking
class VulnerabilityRemediationSLA:
    SEVERITY_MATRIX = {
        "CRITICAL": {"response_hours": 1, "patch_hours": 4},
        "HIGH": {"response_hours": 24, "patch_hours": 168},
        "MEDIUM": {"response_hours": 168, "patch_hours": 720},
        "LOW": {"response_hours": 2592, "patch_hours": None}
    }

    def check_sla_compliance(self, vuln_id, discovery_time, current_time):
        vuln = self.get_vulnerability(vuln_id)
        sla = self.SEVERITY_MATRIX[vuln.severity]

        hours_elapsed = (current_time - discovery_time).total_seconds() / 3600
        response_sla = sla["response_hours"]

        if hours_elapsed > response_sla:
            self.escalate_to_security_lead(vuln_id)
            return False
        return True
```

### Control 4: Automated Patch Application

**Root Standard:** ISO 27001 A.8.22 (Change Management)

**Implementation Pattern:**

- Dependabot/Renovate auto-patches non-breaking changes
- Pull requests created, tested, auto-merged if passing
- Human review required for major version bumps
- Backport patches for active release branches

**Compliant Example:**

```yaml
# Renovate Config (renovate.json)
{
  "extends": ["config:base"],
  "vulnerabilityAlerts":
    {
      "labels": ["security"],
      "assignees": ["@security-team"],
      "reviewers": ["@security-team"],
    },
  "postUpdateOptions": ["gomodTidy", "npmDedupe", "yarnDedupeHighest"],
  "packageRules":
    [
      {
        "matchUpdateTypes": ["patch", "minor"],
        "matchDatasources": ["pypi", "npm"],
        "automerge": true,
        "automergeType": "pr",
        "automergeStrategy": "squash",
      },
      {
        "matchUpdateTypes": ["major"],
        "reviewers": ["@architecture"],
        "minimumReleaseAge": "7 days",
      },
    ],
}
```

### Control 5: Incident Response Automation

**Root Standard:** NIST SP 800-61 (Incident Response)

**Implementation Pattern:**

- Zero-day/active threat detected → automatic build/test/deploy
- If patch available: apply patch, run tests, deploy to production
- If no patch: disable affected feature, escalate to decision makers
- Post-remediation forensics: audit logs, canary deployments

**Compliant Example:**

```bash
#!/bin/bash
# Incident response workflow

CVE_ID="CVE-2024-1234"
SEVERITY="CRITICAL"

# Step 1: Identify affected deployments
AFFECTED=$(jq -r '.affected_versions[]' cve-registry.json | grep "$CVE_ID")

# Step 2: Check for available patch
PATCH=$(curl -s https://nvd.nist.gov/api/cvss/$CVE_ID | \
  jq -r '.patch_available')

if [ "$PATCH" = "true" ]; then
  echo "Patch available, triggering auto-remediation"

  # Step 3: Apply patch
  cargo update --aggressive
  npm audit fix
  pip list --outdated | pip install -U

  # Step 4: Run test suite
  make test

  # Step 5: Deploy to canary
  kubectl set image deployment/app-canary app=app:patched-$GITHUB_SHA
  sleep 5m

  # Step 6: Monitor canary metrics
  if check_canary_health; then
    # Step 7: Full rollout
    kubectl set image deployment/app app=app:patched-$GITHUB_SHA
    echo "Remediation complete"
  else
    echo "Canary degraded, rolling back"
    kubectl rollout undo deployment/app
  fi
else
  echo "No patch available - escalating to security@org"
  # Disable affected feature
  kubectl set env deployment/app FEATURE_XYZ_ENABLED=false
fi
```

### Control 6: False Positive Management

**Root Standard:** ISO 27001 A.8.15 (Monitoring & Logging)

**Implementation Pattern:**

- Scanner false positives tracked and suppressed
- Suppression tracked with expiration date (prevent stale suppressions)
- Audit trail maintained for suppression decisions
- Regular review of suppressions for remediation opportunities

**Compliant Example:**

```yaml
# Grype suppression file (.grype.yaml in root)
suppress:
  - vulnerability: CVE-2023-99999
    component:
      name: "safe-library"
      version: "1.0"
    reason: "vulnerability_not_exploitable"
    impact_statement: "Safe-library does not use affected code path"
    expiration: "2025-02-15" # Re-evaluate in 12 months
    tracking_issue: "https://github.com/org/repo/issues/12345"

  - vulnerability: GHSA-xxxx-yyyy-zzzz
    component:
      name: "test-dependency"
    reason: "false_positive"
    impact_statement: "Affects only dev environment, not production"
    expiration: "2026-02-15"
    reviewed_by: "security@org"
```

### Control 7: Compliance-Driven Remediation

**Root Standard:** SOC 2, PCI-DSS, HIPAA

**Implementation Pattern:**

- Compliance frameworks have stricter SLAs (e.g., PCI-DSS = 30 days)
- Automated enforcement with compliance team notifications
- Audit reports correlate CVE remediation to compliance timeline
- Regulatory filing documents include remediation attestation

**Compliant Example:**

```json
{
  "compliance_remediation_policy": {
    "pci_dss": {
      "critical_vulnerabilities": {
        "sla_days": 30,
        "notification_days": 1,
        "enforcement": "block_payment_processing"
      },
      "high_vulnerabilities": {
        "sla_days": 90,
        "notification_days": 7
      }
    },
    "hipaa": {
      "critical_vulnerabilities": {
        "sla_days": 48,
        "enforcement": "audit_trigger"
      }
    },
    "soc2": {
      "all_vulnerabilities": {
        "tracking_required": true,
        "monthly_reporting": true
      }
    }
  },
  "active_violations": [
    {
      "cve": "CVE-2024-0001",
      "compliance_framework": "pci_dss",
      "days_remaining": 5,
      "action": "escalate_to_ciso"
    }
  ]
}
```

### Control 8: Auditability & Forensics

**Root Standard:** ISO 27001 A.8.15 (Monitoring & Logging)

**Implementation Pattern:**

- All vulnerability events logged with timestamp + actor
- Detection → remediation → deployment sequence tracked
- Post-incident analysis enabled (which versions were vulnerable)
- Audit trail immutable (append-only logging)

**Compliant Example:**

```json
{
  "vulnerability_audit_log": [
    {
      "event_id": "audit-123456",
      "timestamp": "2026-02-15T09:30:00Z",
      "event_type": "VULNERABILITY_DETECTED",
      "cve_id": "CVE-2024-1234",
      "source": "trivy-scanner-pod",
      "severity": "CRITICAL",
      "affected_images": ["app:v1.0", "app:v1.1", "app:v1.2"],
      "detection_method": "container_image_scan"
    },
    {
      "event_id": "audit-123457",
      "timestamp": "2026-02-15T09:35:00Z",
      "event_type": "REMEDIATION_STARTED",
      "cve_id": "CVE-2024-1234",
      "remediation_action": "dependency_update",
      "triggered_by": "security-automation",
      "patch_version": "1.0.1"
    },
    {
      "event_id": "audit-123458",
      "timestamp": "2026-02-15T09:50:00Z",
      "event_type": "DEPLOYMENT_COMPLETE",
      "cve_id": "CVE-2024-1234",
      "deployment_id": "deploy-xyz",
      "status": "success",
      "affected_pods": 42,
      "verified_by": "deployment-verification-bot"
    }
  ]
}
```

## CI/CD Integration Gates

### Pre-Build Gate

```bash
- [ ] Known vulnerabilities in direct dependencies documented
- [ ] Baseline vulnerability report established
- [ ] SLA policy reviewed and understood by team
```

### Build Gate

```bash
- [ ] SCA scan completes without CRITICAL findings
- [ ] Dependency lock file includes vulnerability data
- [ ] Container base image vulnerabilities assessed
- [ ] Build fails if CRITICAL vulnerabilities detected
```

### Pre-Publish Gate

```bash
- [ ] All vulnerabilities have remediation status (patched/suppressed)
- [ ] CRITICAL vulns have supporting documentation
- [ ] Suppressions valid and not-expired
- [ ] Container image scan passes
```

### Deploy Gate

```bash
- [ ] Runtime vulnerability scan on deployed version
- [ ] No new vulnerabilities compared to baseline
- [ ] Audit log updated with deployment version
- [ ] Compliance SLA status verified
```

## Developer Checklist

Before releasing version with vulnerability data:

- [ ] **SCA tool installed** (Grype, Trivy, or equivalent)
- [ ] **Dependencies scanned** (direct + transitive)
- [ ] **CRITICAL vulnerabilities addressed** (patched or documented)
- [ ] **HIGH vulnerabilities tracked** (remediation plan documented)
- [ ] **False positives suppressed** (with expiration date)
- [ ] **Patch availability checked** (upstream or workaround)
- [ ] **SLA compliance verified** (current time < deadline)
- [ ] **Audit trail recorded** (who, when, why for each change)
- [ ] **Compliance frameworks reviewed** (PCI-DSS, HIPAA, SOC2 specific SLAs)
- [ ] **Automated remediation enabled** (patch automation tools configured)
- [ ] **Incident response plan ready** (zero-day procedures documented)
- [ ] **Post-remediation verification** (tests passing, no regression)
- [ ] **Forensics capture enabled** (immutable audit logs)
- [ ] **Team training completed** (developers understand SLA & automation)

**Deployment blocked if any MANDATORY item fails.**

## Control Mapping

| EATGF Control                          | ISO 27001:2022 | NIST SSDF | OWASP SAMM | COBIT 2019 |
| -------------------------------------- | -------------- | --------- | ---------- | ---------- |
| Continuous Vulnerability Scanning      | A.8.16         | RV.1      | Verify.2   | BAI09      |
| Multi-Source Vulnerability Aggregation | A.8.16         | RV.1      | Verify.2   | DSS05      |
| Severity-Based SLA Management          | A.8.16         | RV.1      | Verify.3   | DSS01      |
| Automated Patch Application            | A.8.22         | PW.7      | Build.3    | BAI07      |
| Incident Response Automation           | A.8.16         | RV.1      | Verify.3   | DSS02      |
| False Positive Management              | A.8.15         | RV.1      | Verify.1   | MEA01      |
| Compliance-Driven Remediation          | A.8.16         | RV.1      | Verify.3   | DSS04      |
| Auditability & Forensics               | A.8.15         | RV.1      | Verify.1   | MEA02      |

## Governance Implications

### If Not Implemented

**Undetected Vulnerabilities:**

- Risk: CVE in production dependency, never scanned
- Impact: Breach via known attack vector
- Audit finding: ISO 27001 A.8.16 (Vulnerability management) violation

**SLA Violations:**

- Risk: CRITICAL CVE, patched in 60 days instead of 24 hours end-to-end (represents failure scenario, not SLA)
- Impact: Prolonged exposure window, attacker advantage
- Audit finding: NIST SSDF RV.1 (Vulnerability response) violation

**Patch Chaos:**

- Risk: Manual patching, inconsistent across deployments
- Impact: Some instances patched, others vulnerable
- Audit finding: ISO 27001 A.8.22 (Change management) violation

**Incident Blindness:**

- Risk: Breach occurs, cannot determine which customers affected
- Impact: Over-notification (embarrassment) or under-notification (legal liability)
- Audit finding: ISO 27001 A.8.15 (Logging) violation

## Official References

- [NIST SP 800-53 SI-2: Flaw Remediation](https://csrc.nist.gov/publications/detail/sp/800-53/rev-5)
- [NIST SP 800-61: Computer Security Incident Handling Guide](https://csrc.nist.gov/publications/detail/sp/800-61/rev-2)
- [ISO/IEC 27001:2022 A.8.16: Vulnerability Management](https://www.iso.org/standard/27001)
- [NIST SSDF RV.1: Vulnerability Response](https://csrc.nist.gov/publications/detail/sp/800-218/final)
- [Anchore Grype: Vulnerability Detection](https://github.com/anchore/grype)
- [Aquasecurity Trivy: Container Scanning](https://github.com/aquasecurity/trivy)
- [Google OSV: Open Source Vulnerabilities](https://osv.dev)
- [Dependabot: Automated Dependency Updates](https://docs.github.com/en/code-security/dependabot)

## Version Information

| Field              | Value                                  |
| ------------------ | -------------------------------------- |
| **Version**        | 1.0                                    |
| **Release Date**   | 2026-02-15                             |
| **Change Type**    | Major (First Release)                  |
| **EATGF Baseline** | v1.0 (Phases 12a-b Complete)           |
| **Next Review**    | Q2 2026 (NIST SP 800-218 v1.1 release) |
| **Author**         | EATGF Governance Council               |
| **Status**         | Ready for Enterprise Deployment        |
| **SLA Framework**  | CRITICAL (15min→1hr→4hr deployment→24hr end-to-end), HIGH (24hrs-1wk)    |
| **Audit Scope**    | ISO 27001 A.8.16 + NIST SSDF RV.1 + Incident Mgmt  |
